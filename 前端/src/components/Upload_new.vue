<template>	<div class="upload">
				<select v-model="selectedAlbum" class="targetalbum">			<option v-for="a in $root.children[0].albums">				{{a.name}}			</option>					</select>		<input id="file" multiple="multiple" type="file"  @change="showImg()"/>		<mt-button type="defualt" size="normal" @click="chooseFile()" class="btn">选择文件</mt-button>		<mt-button type="primary" size="normal" @click="upload()" class="btn">开始上传</mt-button>		<div id="imgs" ></div>	</div></template><script>const qiniu = require('qiniu-js')// import Mint from 'mint-ui';export default{		name:"Upload",		data:function(){			return{				selectedAlbum:"默认相册"			}		},		methods:{			upload:function(){				var vm = this;				//获取文件所有照片				let files = document.querySelector("#file").files;				//获取选择的目录				//获取上传文件的token				this.$root.axios.get("/server/user/getToken",{					params:{						token:vm.$root.$childern[0].token,						}				}).then(function(res){					console.log(res);					if(res.data.code==101){						let qntoken =  res.data.msg;						//准备上传文件						vm.uploadFiles(files,qntoken);					}else{						console.log("token is wrong");					}				}).catch(function(err){					console.log(err);				})			},			uploadFiles:function(files,qntoken){			for(let i=0;i<files.length;i++){				let file=files[i];				const observer = {					  next(res){						// 上端进度						console.log("上传进度",res);					  },					  error(err){						// 上传错误						console.log(err);					  },					  complete(res){						// 上传完成						console.log("上传成功",res);					    let key=res.key;						let name=file.name;						let album =vm.selectedAlbum;						let token=vm.$root.$children[0].token;						vm.$root.axios.get("/server/user/upload",{							params:{								key:key,								name:name,								album:album,								token:token							}						}).then(function(res){							console.log("上传到服务器",res);						}).catch(function(err){							console.log(err);						})											  }					}					const observable = qiniu.upload(file, null, qntoken,{}, {})					const subscription = observable.subscribe(observer) // 上传开始				}			},			chooseFile:function(){				document.querSelector("#file").click();							},			showImg:function(){				let imgs=document.querySelector("#files");				let files=document.querySelector("#files").files;				for(var i=0 ; i<files.length ;i++){					let file =files[i];					let img =document.createElement("img");					let fileReader=new 	FileReader();					fileReader.onload=function(){						img.src=fileReader.result;						img.style.width="100%";											}					fileReader.readDataURL(file);					//创建一个div					let div=document.createElement("div");					div.style.height="180px";					div.style.width="48%";					div.style.float="left";					div.style.marginLeft="4px";					div.style.overflow="hidden";					//进度条 ß					let progress=document.createElement("div");					progress.className="img"+i;					progress.style.backgroundColor="skyblue";					progress.style.width="0%";					progress.style.height="4px";					progress.style.float="left";					//进度放进div中					div.appendChild(progress);					//照片放进div中					div.appendChild(img);					//把div存入imgs					imgs.appendChiled(div);				}			}		}}</script><style>	.targetalbum{		width: 100%;		background:#FAFAFA;		height: 30px;	}	.upload{		margin-top: 6px;	}	#file{		position: absolute;		left: -1000px;	}	.btn{		margin-top: 6px;		margin-bottom: 6px;		margin-left: 15%;			}</style>